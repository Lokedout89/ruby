language: none
matrix:
  include:
    - nodePool: shippable_shared_aarch64
      env: BASE_IMAGE=arm64v8/ubuntu
    - nodePool: shippable_shared_aarch32
      env: BASE_IMAGE=arm32v7/ubuntu
build:
  ci:
    # Show environment.
    - uname -a
    - echo "BASE_IMAGE=$BASE_IMAGE"
    - |
      docker build --rm -t "test/ruby/${BASE_IMAGE}" \
        --build-arg BASE_IMAGE="${BASE_IMAGE}" -f tool/ci/Dockerfile .
    - docker run --rm -t --network=host "test/ruby/${BASE_IMAGE}" tool/ci/test.sh
